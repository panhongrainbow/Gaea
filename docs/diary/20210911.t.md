# 2021年09月11日 開發日誌

> - 目前是規劃不同的 "數據庫名稱" 用於不同的測試情境，比如現在小說 novel 是用來測試最簡單的切片規則，兩個切片，兩台主數據庫，四台從數據庫，兩組叢集
> - 所以當數據庫名稱從數據庫池傳到直連 DC 時，DC 才會知道要回傳小說相關的模擬假資料

## [現象 數據庫池不會傳送數據庫名稱到直連 DC ]

可以經由以下原始程式碼得知，數據庫池不會傳送數據庫名稱到直連 DC

<img src="/home/rongster/.config/Typora/typora-user-images/image-20210911221912621.png" alt="image-20210911221912621" style="zoom:80%;" /> 

可以看到紅色圈起來的地方，並不會數據庫名稱傳入，這樣之後的直連很難得知將要操作的數據庫

## [造成問題 產生假資料會較不方便]

到直連時 dc，最後一定要手動指定數據庫名稱 if err := dc.Trans.UseDB("novel"); err != nil {

<img src="/home/rongster/.config/Typora/typora-user-images/image-20210911225918434.png" alt="image-20210911225918434" style="zoom:80%;" /> 

## [數據傳送 之後數據庫名稱傳送]

最後數據庫名稱 (之前手動指定為 novel) 經由 指標 傳送到各個函式的內部，就可以指定修改指定模擬數據庫的資料

<img src="/home/rongster/.config/Typora/typora-user-images/image-20210911232833964.png" alt="image-20210911232833964" style="zoom:80%;" /> 
